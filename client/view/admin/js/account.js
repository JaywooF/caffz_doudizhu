var lib={load:0,search:function(_path){var _keyword=$("input[name='keyword']").val().replace(/^\s+|\s+$/g,"");if(/[^\x21-\x7e]|[&][#]?[a-zA-Z0-9]+[;]/.test(_keyword)){layer.alert("帐号不符合规范！",{icon:7})}else if(_keyword.length<6||_keyword.length>24){layer.alert("帐号最短6位、最长24位！",{icon:7})}else{location.href=_path+"index.php/admin/account/init/keyword:"+encodeURIComponent(_keyword)}},checkbox:function(_id,_this){if(isNaN(_id)){if($(_this).attr("checked")){$(_this).attr("checked",false);$("input[name='"+_id+"'][type='checkbox']").each(function(){$(this).is(":checked")&&$(this).click()})}else{$(_this).attr("checked",true);$("input[name='"+_id+"'][type='checkbox']").each(function(){$(this).is(":checked")||$(this).click()})}}else{if($(_this).attr("checked")){$(_this).attr("checked",false)}else{$(_this).attr("checked",true)}}},add:function(_path,_token){var _account_name=$("input[name='account_name']").val().replace(/^\s+|\s+$/g,"");var _account_pw=$("input[name='account_pw']").val().replace(/^\s+|\s+$/g,"");var _account_rpw=$("input[name='account_rpw']").val().replace(/^\s+|\s+$/g,"");if(/[^\x21-\x7e]|[&][#]?[a-zA-Z0-9]+[;]/.test(_account_name)){layer.alert("管理员帐号不符合规范！",{icon:7})}else if(_account_name.length<6||_account_name.length>24){layer.alert("管理员帐号最短6位、最长24位！",{icon:7})}else if(/[^\x21-\x7e]|[&][#]?[a-zA-Z0-9]+[;]/.test(_account_pw)){layer.alert("管理员密码不符合规范！",{icon:7})}else if(_account_pw.length<6||_account_pw.length>24){layer.alert("管理员密码最短6位、最长24位！",{icon:7})}else if(_account_pw!=_account_rpw){layer.alert("两次输入的密码不一致！",{icon:7})}else{this.load=layer.load(1);$.post(_path+"index.php/admin/account/insert",{account_name:_account_name,account_rpw:_account_rpw,token:_token},function(data){layer.close(lib.load);if(data==1){layer.msg("新增成功...",{icon:16});setTimeout("location.href='"+_path+"index.php/admin/account'",1e3)}else if(data==-1){layer.msg("登录已超时！",{icon:4})}else if(data==-2){layer.msg("管理员帐号已存在！",{icon:5})}else{layer.msg(data,{time:0,btn:["确定"]})}})}},edit:function(_id,_path,_token){var _account_pw=$("input[name='account_pw']").val().replace(/^\s+|\s+$/g,"");var _account_rpw=$("input[name='account_rpw']").val().replace(/^\s+|\s+$/g,"");if(/[^\x21-\x7e]|[&][#]?[a-zA-Z0-9]+[;]/.test(_account_pw)){layer.alert("管理员密码不符合规范！",{icon:7})}else if(_account_pw.length<6||_account_pw.length>24){layer.alert("管理员密码最短6位、最长24位！",{icon:7})}else if(_account_pw!=_account_rpw){layer.alert("两次输入的密码不一致！",{icon:7})}else{this.load=layer.load(1);$.post(_path+"index.php/admin/account/update",{account_id:_id,account_rpw:_account_rpw,token:_token},function(data){layer.close(lib.load);if(data==1){layer.msg("修改成功...",{icon:16});setTimeout("location.href='"+_path+"index.php/admin/account'",1e3)}else if(data==-1){layer.msg("登录已超时！",{icon:4})}else{layer.msg(data,{time:0,btn:["确定"]})}})}},del:function(_confirm,_id,_path,_token){var _checkbox=[];$("input[name='"+_id+"'][type='checkbox']:checked").each(function(){_checkbox.push($(this).val())});if(_checkbox.length<1){layer.alert("请先勾选要删除的数据！",{icon:7})}else if(_confirm<1){layer.confirm("确定要删除所选的数据吗？",{icon:3,btn:["确定","取消"]},function(){lib.del(1,_id,_path,_token)})}else{this.load=layer.load(1);$.post(_path+"index.php/admin/account/delete",{checkbox:_checkbox,token:_token},function(data){layer.close(lib.load);if(data==1){layer.msg("删除数据成功...",{icon:16});setTimeout("location.reload()",1e3)}else if(data==-1){layer.msg("登录已超时！",{icon:4})}else{layer.msg(data,{time:0,btn:["确定"]})}})}}};